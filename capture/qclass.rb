#!/usr/bin/ruby

module FatNS
  module Truisms
    QCLASS_TABLE = [
    ["ERROR","Reserved"  ,  "[IANA]"], # 0
    ["IN","Internet (IN)"  ,  "[RFC1035]"], # 1
    ["ERROR","Unassigned"  ,  "[IANA]"], # 2
    ["CH","Chaos (CH)"  ,  "[RFC1035]"], # 3
    ["HS","Hesiod (HS)"  ,  "[RFC1035]"], # 4

    ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''],
    ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''],
    ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''],
    ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''],
    ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''],
    ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''],
    ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''],
    ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''],
    ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''],
    ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''],
    ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''],
    ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''],
    ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''],
    ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''],
    ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''],
    ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''],
    ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''], ['','',''],

    ["ERROR","None"  ,  "[RFC2136]"], # 254
    ["ANY","Any [QCLASS Only]"  ,  "[RFC1035]"] # 255
    ]

    # This function gives you the matching DNS query class id
    # for a given type identifier string, +s+.
    def Truisms.get_qclass_id(s)
      QCLASS_TABLE.each_with_index do |t,i|
        return i if (not t.nil?) and t[0] == s
      end
      raise "Invalid DNS query class #{_type}"
    end
  end
end
